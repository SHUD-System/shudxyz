<!doctype html><!-- This site was created with Hugo Blox. https://hugoblox.com --><!-- Last Published: August 2, 2024 --><html lang=en-us><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 5.9.7"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><script src=/js/mathjax-config.js></script><link rel=stylesheet href=/css/vendor-bundle.min.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href=/css/wowchemy.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=baidu-site-verification content="code-caLY3Fu6xB"><meta name=author content="Lele Shu"><meta name=description content="Introduction of the SHUD Model"><link rel=alternate hreflang=en-us href=http://localhost:1313/en/shud/1-shud/><link rel=canonical href=http://localhost:1313/en/shud/1-shud/><link rel=manifest href=/en/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu4b7ba8d7b72b8d90530142c1f3cd9f35_73534_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu4b7ba8d7b72b8d90530142c1f3cd9f35_73534_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#3f51b5"><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@leleshu"><meta property="twitter:creator" content="@leleshu"><meta property="twitter:image" content="http://localhost:1313/media/icon_hu4b7ba8d7b72b8d90530142c1f3cd9f35_73534_512x512_fill_lanczos_center_3.png"><meta property="og:type" content="website"><meta property="og:site_name" content="SHUD Group"><meta property="og:url" content="http://localhost:1313/en/shud/1-shud/"><meta property="og:title" content="The Simulator for Hydrologic Unstructured Domains | SHUD Group"><meta property="og:description" content="Introduction of the SHUD Model"><meta property="og:image" content="http://localhost:1313/media/icon_hu4b7ba8d7b72b8d90530142c1f3cd9f35_73534_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><meta property="og:updated_time" content="2020-11-23T00:00:00+00:00"><link rel=alternate href=/en/shud/1-shud/index.xml type=application/rss+xml title="SHUD Group"><title>The Simulator for Hydrologic Unstructured Domains | SHUD Group</title>
<script async defer src=https://buttons.github.io/buttons.js></script></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=4ad7af73513394598da2593503709820><script src=/js/wowchemy-init.min.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/en/>SHUD Group</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/en/>SHUD Group</a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/en/#home><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/en/project><span>Project</span></a></li><li class=nav-item><a class=nav-link href=/en/team><span>People</span></a></li><li class=nav-item><a class=nav-link href=/en/publication><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/en/course/><span>Course</span></a></li><li class=nav-item><a class=nav-link href=/book_en><span>SHUD Modelüìö</span></a></li><li class=nav-item><a class=nav-link href=/openfunding/><span>Open Funding‚≠ê</span></a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>External-Link</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=https://ghdc.ac.cn><span>Global Hydro Cloudüåè</span></a>
<a class=dropdown-item href=https://shudapp.netlify.app><span>GalleryüñºÔ∏è</span></a></div></li><li class=nav-item><a class=nav-link href=/en/opp><span>Join Us</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav></header></div><div class=page-body><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Overview
</span><span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>Search...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#formulation-and-results-of-shud>Formulation and results of SHUD</a></li><li><a href=#standing-on-the-shoulders-of-giants>Standing on the shoulders of giants</a><ul><li><a href=#brief-history-of-pihm>Brief history of PIHM</a></li><li><a href=#differences-from-pihm>Differences from PIHM</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><div class=docs-article-container></div><div class=docs-article-container><h1>The Simulator for Hydrologic Unstructured Domains</h1><article class=article-style><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=/media/shud_show.png alt loading=lazy data-zoomable></div></div></figure></p><h2 id=formulation-and-results-of-shud>Formulation and results of SHUD</h2><ul><li>SHUD is a physically-based model, in which all equations used to emerge from the physics behind the hydrological processes within a catchment. The physical model can predict the water in an ungaged water system. SHUD represents the spatial heterogeneity that influences the hydrology of the region. Consequently, it is practical to couple the SHUD model with models from biochemistry, reaction transport, geomorphology, limnology and other related research areas.</li><li>SHUD is a fully-coupled hydrological model, where the conservative hydrological fluxes are calculated within the same time step. The state variables are the height of ponding water on the land surface, soil moisture, groundwater level, and river stage, while fluxes are infiltration, overland flow, groundwater recharge, lateral groundwater flow, river discharge, and exchange between river and cells.</li><li>The global ODE system solved in SHUD integrates all local ODE systems over the domain and solves with a state-of-the-art parallel ODE solver known as CVODE (Hindmarsh et al., 2005) developed at the Lawrence Livermore National Laboratory.</li><li>SHUD permits adaptable temporal and spatial resolution. The spatial resolution of the model varies from cen- timeters to kilometers based on modeling requirements computing resources. The internal time step of the iteration is adjustable; it can export the status of a catchment at time-intervals from a minutes to days. The flexible spatial and temporal resolution of the model is valuable for community model coupling.</li><li>SHUD can estimate either a long-term hydrological yield or a single-event flood.</li><li>SHUD is an open-source model &mdash; anyone can access the source code and submit their modifications/improvements.</li></ul><h2 id=standing-on-the-shoulders-of-giants>Standing on the shoulders of giants</h2><h3 id=brief-history-of-pihm>Brief history of PIHM</h3><p>The conceptual structure of the two-state integral-balance model for soil moisture and groundwater dynamics is devised by (Duffy, 1996), in which the partial volumes occupied by unsaturated and saturated moisture storage were integrated di- rectly upon local conservation equation. This two-state integral-balance structure simplified the hydrological dynamics while preserving the natural spatial and temporal scales contributing to runoff response. Brandes et al. (1998) use FEMWATER to realize the numeric calculation of inflow/outflow behavior within a hillslope-stream scheme. In 2004, Qu (2004) embedded the evapotranspiration and river network, and released Penn State Integrated Hydrologic Model (PIHM) v1.0, which is the most important milestone of the two-state integral-balance model. Since PIHM v1.0 (Qu, 2004), the PIHM is a generic hydrological model applicable to various watersheds or basins. After that, PIHM v2.0 (Kumar et al., 2009; Kumar and Duffy, 2009) enhance the land surface modeling. A GIS-tool, PIHMgis(Bhatt et al., 2014) and the Essential Terrestrial Variables Data Server (HydroTerre Leonard and Duffy (2013)) dramatically motivated the model deployment and applications with PIHM. Because of the sophisticated hydrological modeling and efficient spatial representative of PIHM, various model coupling project ini- tialized. For example, Flux-PIHM coupled the NOAH Land Surface Model into PIHM to calculate more details in energy balance and evapotranspiration (Shi et al., 2015, 2014). Zhang et al. (2016) coupled the landscaping evolution with PIHM (LE-PIHM). Bao (Bao, 2016; Bao et al., 2017) coupled the reaction transport module with PIHM (RT-PIHM, RT-Flux-PIHM). Flux-PIHM-BGC (Shi et al., 2018) coupled the biogeochemistry into Flux-PIHM. The Multi-Module PIHM (MM-PIHM) project (<a href=https://github.com/PSUmodeling/MM-PIHM target=_blank rel=noopener>https://github.com/PSUmodeling/MM-PIHM</a>) planned to build a uniform repository for all coupled modules. Still, more PIHM coupling projects are ongoing, such as sediments, lakes, crops, etc.. In addition, a finite volume-based integrated hydrologic modeling (FIHM) was developed (Kumar et al., 2009), which used second-order accuracy and solved 2D unsteady overland flow and 3D subsurface flow. Figure 1 shows the family tree of PIHM and SHUD. Every revision/branch received cross-pollination from others. Although PIHM and SHUD share the same fundamental conceptual two-state integral model, both the input/output are incompatible. Details of differences between them are summarised in the last section of this paper.</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=/Fig/Figure_tree.png alt=Figure_tree loading=lazy data-zoomable></div></div></figure>Figure 1 The family tree of PIHM and SHUD. PIHM and SHUD share the same fundamental conceptual model, but use different realization. The PIHMgis and rSHUD are GIS-tools for pre- and post-processing.</p><h3 id=differences-from-pihm>Differences from PIHM</h3><p>As a descendent of PIHM, SHUD inherits the fundamental idea of solving hydrological variables in CVODE. The code has been completely rewritten in a new programming language, with a new discretization and corresponding improvements to the underlying algorithms, adapting new mathematical schemes and a new user-friendly input/output data format. Although SHUD is forked from PIHM‚Äôs track, SHUD still inherits the use of CVODE for solving the ODE system, but modernizes and extends PIHM‚Äôs technical and scientific capabilities. The major differences are following:</p><ol><li>SHUD is written in C++, an object-oriented programming language with functionality to avoid risky memory leaks from C. Every functions in the code has been rewritten, so the functions, algorithm or data structure between SHUD and PIHM are incompatible.</li><li>SHUD implements a re-design of the calculation of water exchange between hill slope and river. The PIHM defines the river channel as adjacent to bank cells ‚Äì namely, the river channel shares the edges with bank cells. This design leads to sink problems in cells that share one node with a starting river channel.</li><li>The mathematical equations used in infiltration, recharge, overland flow and river discharge are different among the two models. This change is so essential that the model results would be different with the same parameter set.</li><li>SHUD adds mass-balance control within the calculation of each layer of cells and river channels, critical for long-term or micro-scale hydrologic modeling.</li></ol><p>We now briefly summarize the technical model improvements and technical capabilities of the model, compared to PIHM. This elaboration of the relevant technical features aims to assist future developers and advanced users with model coupling. Compared with PIHM, SHUD &mldr;</p><ul><li>supports the latest implicit Sundial/CVODE solver up to version 5.0.0 (the most recent version at time of writing),</li><li>supports OpenMP parallel computation,</li><li>redesigns the data structures and algorithm with object-oriented programming (C++),</li><li>supports human-readable input/output files and filenames,</li><li>exposes unified functions to handle the time-series data, including forcing, leaf area index, roughness length, boundary conditions and melt factor,</li><li>exports model initial condition at specific intervals that can be used for warm starts of continued simulation,</li><li>automatically checks the range of physical parameters and forcing data,</li><li>adds a debug mode that monitors potential errors in parameters and memory operations.</li></ul></article><div class=article-widget><div class=post-nav></div></div></div><div class=body-footer><p>Last updated on Nov 23, 2020</p></div><footer class=site-footer><p class="powered-by copyright-license-text">¬© {2022} SHUD. Âá°ÊàëÂÖ¨ÂºÄÁöÑÔºåÁöÜ‰∏ç‰øùÁïôÁâàÊùÉÔºå‰∫¶‰∏çÁî≥Á¥¢ÊùÉÁõäÔºõ‰ΩÜÈúÄË¶ÅÊÇ®ÂêàÁêÜÂºïÁî®„ÄÇ (I reserve no right on anything in this website. Use it for free with right citation/reference. )</p><p class=powered-by>Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a> ‚Äî the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></main></div></div></div><div class=page-footer></div><script src=/js/vendor-bundle.min.js></script><script src=https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script><script id=page-data type=application/json>{"use_headroom":false}</script><script src=/en/js/wowchemy.min.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy
</a><a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.js type=module></script></body></html>