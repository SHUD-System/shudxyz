---
title: "数值方法分布式水文模型研发(中国科学院率先行动人才项目)"
categories: ["Research"]
tags: ["水文模型", "数值方法", "非结构三角形",  "地表-地下水耦合", "有限体积法", "C/C++"]
subtitle:
summary:
authors:
- Lele Shu
date: 2020-09-03T21:13:14-05:00
lastMod: "2022-08-05T00:00:00Z"
featured: true
draft: false

# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder.
image:
  caption: "SHUD数值水文模型的扩展"
  focal_point: ""

# Projects (optional).
#   Associate this post with one or more of your projects.
#   Simply enter your project's folder or file name without extension.
#   E.g. `projects = ["internal-project"]` references
#   `content/project/deep-learning/index.md`.
#   Otherwise, set `projects = []`.
projects: []
---
## 介绍
数值方法水文模型可视为一类特殊的分布式水文模型，典型特征是采用数值方法，并且紧密耦合了地表和地下水过程。

水文模型面临表达复杂系统的挑战，包含非线性反馈、时空异质性、生物化学过程、生态过程、和人类系统的相互作用，水文模型比如需要在微观到宏观尺度上反映水在复杂系统中的作用，必然催生自下而上的数值方法水文模型(Wagener et al. 2010)。

作为流域水文计算最重要和新兴发展方向，地表-地下集成的数值方法水文模型( Integrated Surface-Subsurface Hydrologic Model with a Numeric Method)利用了数值方法以较高时间分辨率（秒至小时级）计算流域连续水文过程，更接近自然界水的运动本质，更准确反映人类活动影响，以及易于耦合其他物理过程，因而已经获得广泛关注和影响力(Maxwell et al.2014; Paniconi et al. 2015; Peel and McMahon, 2020; Fatichi et al. 2016; Hrachowitz and Clark, 2017)。2000年以来，全球水文研究者新发展了20多个重要的数值方法水文模型(Peel and McMahon; 2020)，包括Mike SHE, ParFlow, CATHY, PAWS, HydroGeoSphere, PIHM, SHUD等。


## 数值方法水文模型的特点
针对数值方法水文模型的特点总结是基于与其他非数值方法的水文模型进行的对比。

###	显著优势
- 强物理过程描述：数值模型常基于物理公式（如达西定律、理查兹方程、圣维南方程、格林-安普公式等）描述流域水文过程。数值模型的参数多基于可测量水力学参数，如土壤水力传导度、土壤孔隙度、地表粗糙度等。数值模型由最基本原理描述来求解整体流域响应，属于自下而上方法，更能表现模拟客观性；即在流域物理过程和空间结构表达上，物理性模型优于概念模型和集总式模型，并且物理性模型有利于无径流观测流域的研究突破。集总式和半分布式模型中常用抽象参数表达重要的水文物理过程，例如SWAT的产流过程由CN值（Curve Number）决定，CN值综合了土壤、土地利用、农业管理、坡度等多个水文信息。
高时间分辨率：由于分布式流域水文模型的高分辨率，依据CFL条件限制，数值模型的时间分辨率运行在秒至小时级别，对于描述流域变化的快过程有显著优势，例如描述洪水过境、洪水淹没以及水化学过程。部分模型具有自适应时间步长——模型算法根据变化速度及系统收敛状况，自动调整时间步长，既显著提高模型整体运行效率，又满足数值计算的收敛性要求。数值模型的对比试验中，由于其模拟对象尺度较小，诸多模型的时间步长在0.001秒至30分钟之间（Kollet et al. 2017)。

- 空间连续性：空间连续性表现为，水文变量在较高分辨率的离散空间内的连续过程，例如水沿着“山顶-半坡-坡脚-河道-河流出口”地表或地下路径传播过程都可以在数值模型中进行跟踪。与之对比，SWAT以水文响应单元为单元计算水的产汇流，但无法描述水从HRU最远点到河流的过程，因而也无法描述污染物在HRU内的传播路径。
地表-地下耦合：更真实地表述了地表地下水的交互过程，同时增强了模型在不同流域的通用性。例如大部分概念性模型固定了地下水向河流的流向——坡面流向河道；因此无法使用统一方法表达干旱地区河流在干旱季节渗漏补给地下水，湿润季节地下水补给河流的过程。数值模型的地表地下紧耦合方法中，地下水与河流交互方向由实时水力梯度决定，即水可以双向流动。传统的以子流域分割的水文模型中，子流域的地下水直接贡献给其径流，并推演至流域出口。这种计算方式在部分山区，无法反映高山区地下水补给，通过深层地下水路径补给给末端径流的过程，而数值方法耦合地表地下方式则可胜任。
土地利用的水力学表达：模型中通过蒸发、地表径流、植被物候规律以及土壤特性变化四个方面来体现土地利用，有效地表达了土地利用的水力学特征。对比SWAT模型，其土地利用特征由CN值表达，CN值缺少足够物理性而难以测量；CN值同时包含土壤透水性和土地利用导致的粗糙度与不透水面积，并且难以表达物候特征，因此模型不确定性较大。
可计算的空间变量多：数值方法模型在水平和垂直方向进行空间划分，因此总体的计算单元数量多，形成三维的计算结果，模拟产生的数据量远大于集总式和半分布式模型，模型高分辨率输出有利于与观测对比，也能更好的指导未来观测布设。

- 利于学科模型紧密耦合：由于数值模型物理机制明确、可计算变量丰富、满足守恒条件约束，并且可以跟踪物质在空间的传输过程，奠定了与其他学科模型深度耦合的理论基础。前文提到的空间连续性有利于多学科的耦合研究，例如模型详细描述水从山坡汇流的路径，方便进行陆面过程（Shi et al. 2015, Kuffour et al. 2020）、地球化学（Shi et al. 2018）、污染物运动(Bao et al. 2017; Li et al. 2017)、农业经济（Cobourn et al. 2018），湖泊动态（Ladwig et al. 2021)、土壤侵蚀及地貌变迁(Yu et al. 2016)， 冰冻圈过程（冰川、冻土、积雪）耦合（Endrizzi et al. 2014）等方面的模型耦合。典型的模型耦合案例包括CLM-PAWS(Shen et al. 2014), CLM-ParFlow(Kuffour et al. 2020), ATS(Painter et al. 2016) Flux-PIHM(Shi et al. 2013), LE-PIHM(Yu et al. 2016)，tRIBS-VEGGIE(Ivanov et al. 2008)等。

###	限制因素
- 参数要求高以及不确定性：参数要求高表现为数量多、可靠性要求高、物理性要求高，调参难度大（Maxwell et al. 2005）。Beven等（Beven 2010）认为集总式模型仅需要3-6个参数即可准确模拟“降雨-产流”过程，但是数值模型由于其控制方程数量以及流域水文过程的复杂性导致其参数数量较高。以水力传导度(Hydraulic Conductivity, K)为例，在SWAT等模型中只需要一个K值，但是SHUD模型(Shu et al. 2020)中，至少需要三个K值，即地表垂直方向、地下垂直方向和地下水平方向三个K值。 SWAT利用CN表达了土壤水利特征、土地利用特征和农业管理，但数值模型通常需要超过10参数表达以上特征。 数值模型中的参数通常具有具体的物理意义，且参数敏感性较强，因此参数的可靠性直接决定模拟结果的优劣。物理参数的值变化范围被限定在特定的合理范围，并且由于其参数数量大，调参的难度大；且无法避免多参同效（Equafinality）问题（Beven 2010）。常见数值方法水文模型自动化调参都采用遗传算法(Hansen 2011; Yu et al. 2014, 2021）。
运行效率不高：数值模型运行在较高的空间分辨率上，由CFL条件决定其运行的时间不长较高，因此总体上其运行效率远低于传统的建立于天尺度的“降雨-产流”模型。计算效率低的主要原因有三个：1）空间HCU数量大，分辨率高；2）计算时间步长小；3）求解方法复杂，模型需要迭代寻找收敛点，

- 建模过程复杂：建模过程复杂表现为：1）水平空间分割复杂，水平空间的分割常见为规则（规则化四边形、三角形、六边形）或不规则分割（三角形、四边形或混合性质）；2）垂直空间分割复杂，包含固定距离分割、水文特征分割或动态分割等；3）空间拓扑关系复杂，主要是指不同计算单元间的耦合关系，包括陆面过程与水文过程的交互关系、显式河道与坡面单元的交互关系等。

- 开发难度大：数值方法水文模型涉及的物理过程众多、数学求解难度大、参数众多、计算资源要求高、模型调试复杂等特点，使得其开发难度大。现有数值模型大多都是多人团队经过多年开发方成形。例如SHUD模型，纵使有PIHM从2004至2020的17年的研究积累，SHUD依然经历6年开发历程。另以PawFlow为例，从其github的代码开发历史看，三人团队研究6年后发布了ParFlow第一版本，其后陆续发布了更新版本，但是合作团队美国普林斯顿大学、科罗拉多矿业大学、华盛顿州立大学、雪城大学、劳伦斯-利佛摩国家实验室，德国的伯恩大学、利希研究中心、地球系统超算中心，法国地球环境研究所等在内的多家实力雄厚的大学和研究机构（见https://parflow.org/#team），足见其研究的重要性和研发难度。

## 总结
数值方法水文模型发展历史并不长，但其更进一步探索自然水循环过程，因而引起了科学和工业界的重视。借助近年工程数学和计算技术的进步，数值方法水文模型的研究越来越多，并展现出其显著优势。
地表地下集成耦合模型结合水文、数学、工程和计算机领域最新发展，因而研发工作的人才、经费和时间投入巨大，一定程度阻碍了数值方法水文模型快速发展。

与此同时，我国学界对于数值方法水文模型的探讨、开发和应用都非常薄弱，因此亟需在此领域的原创性、基础性探索；在支持新模型研发的同时，加强已有模型在全球的验证、推广和改进研究，不仅实践中给科学研究和工程应用提供支撑，也能够改进和提升对自然水循环的理解。

中国科研面临“缺芯少软”局面，不仅制约我国科学研究前进步伐，也给未来发展埋下隐患。与国外研究比，我国在地表地下集成数值方法水文模型的开发、测试和应用方面研究都较为薄弱，受制于代码开源、数据制备、全球适应性验证等限制，国产模型工作尚未展示出足够科学影响力。因此，我国科学界亟需数值方法水文模型方向的开放性平台和原创性贡献。
